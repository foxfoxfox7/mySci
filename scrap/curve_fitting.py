import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit


SD000 = [0.33635326195770454, 0.23120391760286724, 0.17029532566877412, 0.13850086009621682, 0.12165189875455983, 0.11244302462285796]
SD050 = [0.3316258573165482, 0.19763860466315755, 0.13815385713928163, 0.11471612138210897, 0.10520750444799754, 0.10142373435575926]
SD100 = [0.32787475020014373, 0.18732158111944985, 0.13029538541820496, 0.10984753260715648, 0.10188641761301666, 0.098812757899423703]
SD150 = [0.32871023698012947, 0.18844812426231197, 0.13310675298551322, 0.11303231871228617, 0.10491408015276979, 0.10136978335030512]
SD200 = [0.34509866205965944, 0.20729847144452035, 0.15296520212365222, 0.13089366131107671, 0.12057963745708983, 0.11499003738367998]
SD250 = [0.36210048283663421, 0.22718503327434431, 0.17302236779032773, 0.14788603323351165, 0.13458578158876269, 0.12653412270776637]
SD300 = [0.37480807245574399, 0.24476635204399502, 0.19104496148976038, 0.16563766340132863, 0.14951095045426546, 0.13932022882382061]
SD350 = [0.37331696262959968, 0.25123051148676961, 0.19904513363760687, 0.174331850218577, 0.15855465997230209, 0.14824378010496631]
SD400 = [0.39508244668715092, 0.27797622171589947, 0.224123802366789, 0.19850639439834217, 0.17859459151968521, 0.16455977742333217]
SD450 = [0.37338573643890649, 0.26253862293393132, 0.21200794107022383, 0.19073599926812979, 0.17461988344781265, 0.16350066943016564]

depo_curves = [SD000, SD050, SD100, SD150, SD200, SD250, SD300, SD350, SD400, SD450]




timeStep = 40
x = []
for i in range(len(SD000)):
	x.append(i*timeStep)

def get_exp_fit(x, y, save=False):

	x = np.array(x, dtype=float)
	yn = np.array(y, dtype=float)

	def func(x, a, b, c):
	    return a * np.exp(-b * x) + c

	popt, pcov = curve_fit(func, x, yn, p0 = (x[0], 0.01, x[-1]))#, 


	plt.figure()
	plt.plot(x, yn, 'ko', label="Original Noised Data")
	plt.plot(x, func(x, *popt), 'r-', label="Fitted Curve")
	plt.legend()
	if save:
		plt.savefig('the_title.png')
	plt.show()

	return popt

exp_param = []
for curve in depo_curves:
	fit_params = get_exp_fit(x, curve)
	exp_param.append(fit_params[1])

static_dis = [0, 50, 100, 150, 200, 250, 300, 350, 400, 450]

plt.plot(static_dis, exp_param)
plt.show()